pipeline {
    agent any
    tools {
        maven 'Maven'
    }
    stages {
    stage("build jar") {
         steps {
        script {
        echo " Building the application"
        bat "mvn clean package"
        }
        }
        }

    stage("building image") {
        steps {
        script {
        echo " Building the docker image"
        withCredentials([usernamePassword(credentialsId:'my-docker-repo', passwordVariable: 'Pass', usernameVariable: 'User')]){
        bat "docker build -t shahzadk1/my-repo: 1.1 ."
         bat "echo %PASS% | docker login -u %USER% --password-stdin"
        bat "docker push shahzadk1/my-repo:1.1"
        }
        }
        }
        }
    stage("Deploy") {
    steps{
    script {
    echo " Deploying the Application.."
    }
    }
    }

}

